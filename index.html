<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Keyword Extractor Tool</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Keyword Extractor</h1>
        <textarea id="text-input" placeholder="Paste your text here..."></textarea>
        <button onclick="extractKeywords()">Extract Keywords</button>
        <div id="result"></div>
        <footer>
            <a href="privacy.html" style="color:blue;">Privacy Policy</a> |
            <a href="about.html" style="color:blue;">About Us</a>
        </footer>
    </div>
    <script>
        function extractKeywords() {
            const text = document.getElementById("text-input").value;
            const words = text.toLowerCase().match(/\b\w+\b/g);
            if (!words) return document.getElementById("result").innerHTML = "No keywords found.";

            const freq = {};
            words.forEach(word => {
                if (word.length > 3) freq[word] = (freq[word] || 0) + 1;
            });

            const sorted = Object.entries(freq).sort((a, b) => b[1] - a[1]);
            const top = sorted.slice(0, 20).map(([word, count]) => `<li>${word} (${count})</li>`).join("");
            document.getElementById("result").innerHTML = `<ul>${top}</ul>`;
        }
    </script>
</body>
</html>
